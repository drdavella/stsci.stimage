set repo=https://svn.stsci.edu/svn/ssb/stsci_python/stsci_python

set branch=release_2011_08

set VER=2.12


How to make an stsci_python release branch
--

# Make a branch of stsc_python in the stsci_python repository.

svn copy  $repo/trunk  $repo/branches/$branch

# check it out
svn checkout  -q $repo/branches/$branch


# fix up the svn externals
cd $branch
release_tools/branch_externals

... perform the svn commands that it displays

vi setup.py
	# change the version number in the call to setup at the end of the file
	# commit the change

** abandon your checked out copy and get a new one **



How to make the release tarball
--

nag everybody to fix their version numbers

nag everybody to get their stuff into RELEASE_NOTES

svn checkout  -q $repo/branches/$branch stsci_python
	# this will get everything through the svn:externals

cd stsci_python

vi `find . -name defsetup.py`
	# change the version numbers to match the __init__ files
svn commit -m'fix version numbers'

vi testpk.py
	# change expected version numbers to be right

release_tools/svnversion
	# not in 2011_3

find . -name .svn -exec rm -rf {} ';'

rst2html.py < INSTALL.rst > INSTALL.html

cd ..

mv stsci_python stsci_python-$VER

mkdir -p /eng/ssb/dist/$branch

rm -f  /eng/ssb/dist/$branch/stsci_python-$VER.tar.gz 

tar zcf /eng/ssb/dist/$branch/stsci_python-$VER.tar.gz  stsci_python-$VER



How to test the release
--

cd to the work directory where you will do the testing

unsetenv PYTHONPATH

irafdev

echo $PYTHONPATH

setenv PYTHONPATH ...take off the part that has stsci_python in it...

svn checkout -q $repo/branches/$branch/release_tools 

sh release_tools/testenv
	paste the appropriate commands from what it displayed
		set path, pythonpath
		uninstall
		install setup.py

tar xf /eng/ssb/dist/$branch/stsci_python-$VER.tar.gz

cd stsci_python-$VER

python setup.py -q install --home $pyhome

python testpk.py

cd /arzach/data1/rt

setenv PDK_TESTRUN $branch-`date +%H-%M`.XXXXXX    <- fill in an identifier for XXXX

pdkrun -r --parallel 4 stsci_python/ astrolib/pysynphot >& log


How to generate the epydoc web pages
--

...


How to make windows distribution
--

On Mac:

	cd ~/Desktop
	rm -rf build
	mkdir build
	cd build

	tar xf /eng/ssb/dist/$branch/stsci_python-$VER.tar.gz

On Windows VM:

	start->All Programs->MinGW->MSYS->msys
		starts a xterm-like program; don't resize it

	cd //.host/Shared\ Folders/Desktop/build	

	VER=`ls | sed 's/^.*-//'`

        which python
		says /c/python27/python

	cd stsci_python-$VER 

	python setup.py build --compiler=mingw32
		# test 

	python setup.py bdist_wininst


On Mac:
	cd ~/Desktop/build/stsci*/dist
	cp *.exe /eng/ssb/dist/$branch



Install locally
--

cd /usr/stsci/pyssg
	rm -rf 2.7.1.stsci_python 2.7.stsci_python
	mkdir 2.7.1.stsci_python
	ln -s  2.7.stsci_python 2.7.1.stsci_python/

cd $workdir

unsetenv PYTHONPATH

iraf

rm -rf stsci_python-$VER

tar zxf /eng/ssb/dist/$branch/stsci_python-$VER.tar.gz 

cd stsci_python-$VER

python uninstall.py -f

set d=`echo $PYTHONPATH | sed 's/:.*$//' `

python setup.py -q install --install-lib $d 

python testpk.py


