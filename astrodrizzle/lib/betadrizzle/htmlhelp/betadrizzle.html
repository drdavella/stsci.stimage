

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Primary User Interface: MultiDrizzle() &mdash; betadrizzle v4.0.6 documentation</title>
    <link rel="stylesheet" href="_static/stsci_sphinx.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '4.0.6',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="betadrizzle v4.0.6 documentation" href="index.html" />
    <link rel="next" title="imageObject Classes" href="imageobject.html" />
    <link rel="prev" title="Welcome to betadrizzle’s documentation!" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="np-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="imageobject.html" title="imageObject Classes"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to betadrizzle’s documentation!"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">betadrizzle v4.0.6 documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/stsci_logo.png" alt="Logo"/>
            </a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Welcome to betadrizzle&#8217;s documentation!</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="imageobject.html"
                        title="next chapter">imageObject Classes</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/betadrizzle.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-betadrizzle">
<span id="primary-user-interface-multidrizzle"></span><span id="betadrizzle"></span><h1>Primary User Interface: MultiDrizzle()<a class="headerlink" href="#module-betadrizzle" title="Permalink to this headline">¶</a></h1>
<p>astrodrizzle - test implementation of MultiDrizzle: The Next Generation</p>
<p>astrodrizzle automates the process of aligning images in an output frame, identifying cosmic-rays, removing distortion, and then combining the images while removing the identified cosmic-rays.</p>
<dl class="docutils">
<dt>This process involves a number of steps; namely:</dt>
<dd><ol class="first last arabic simple">
<li>Processing the input images and input parameters</li>
<li>Creating a static mask</li>
<li>Performing sky subtraction</li>
<li>Drizzling onto separate output images</li>
<li>Creating the median image</li>
<li>Blotting the median image</li>
<li>Identifying and flagging cosmic-rays</li>
<li>Final combination</li>
</ol>
</dd>
</dl>
<p>A full description of this process can be found in the MultiDrizzle Handbook available online at:</p>
<p><a class="reference external" href="http://stsdas.stsci.edu/multidrizzle">http://stsdas.stsci.edu/multidrizzle</a></p>
<p><strong>Output</strong>: The primary output from this task is the distortion-corrected, cosmic-ray cleaned combined image as a FITS file.</p>
<p>This task requires numerous user-settable parameters to control the primary aspects of each of the processing steps.</p>
<dl class="function">
<dt id="betadrizzle.MultiDrizzle">
<tt class="descclassname">betadrizzle.</tt><tt class="descname">MultiDrizzle</tt><big>(</big><em>input</em>, <em>editpars=False</em>, <em>configObj=None</em>, <em>wcsmap=None</em>, <em>**input_dict</em><big>)</big><a class="headerlink" href="#betadrizzle.MultiDrizzle" title="Permalink to this definition">¶</a></dt>
<dd><p>betadrizzle Version 4.0.14dev12812 updated on 12-May-2011</p>
<p>MultiDrizzle automates the process of aligning images in an output frame, identifying cosmic-rays, removing distortion, and then combining the images while removing the identified cosmic-rays.</p>
<p>This task requires numerous user-settable parameters to control the primary aspects of each of the processing steps.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name" colspan="2">Parameters :</th></tr>
<tr><td>&nbsp;</td><td class="field-body"><p class="first"><strong id="files">files</strong> : str or list of str</p>
<blockquote>
<blockquote>
<p>The name or names of the input files to be processed which can be provided in any of several forms; namely:</p>
<blockquote>
<ul class="simple">
<li>filename of a single image</li>
<li>filename of an association (ASN) table</li>
<li>wild-card specification for files in directory</li>
<li>comma-separated list of filenames</li>
<li><a class="reference external" href="mailto:'&#37;&#52;&#48;file">'<span>&#64;</span>file</a>&#8216; filelist containing list of desired input filenames. The file list needs to be provided as an ASCII text file containing a list of filenames for all input images with one filename on each line of the file. If inverse variance maps (IVM maps) have also been created by the user and are to be used (by specifying &#8216;IVM&#8217; to the parameter final_wht_type, then these are simply provided as a second column in the filelist, with each IVM filename listed on the same line as a second entry, after its corresponding exposure filename.</li>
</ul>
</blockquote>
</blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If the user specifies &#8216;IVM&#8217; for the &#8216;final_wht_type&#8217; but does not provide the names of IVM files, MultiDrizzle will automatically generate the IVM files itself for each input exposure.</p>
</div>
</blockquote>
<p><strong id="editpars">editpars</strong> : bool</p>
<blockquote>
<p>Specifies whether or not to use the TEAL GUI to edit the full set of parameters described in the section on the full set of parameters.</p>
</blockquote>
<p><strong id="configObj">configObj</strong> : object, optional</p>
<blockquote>
<p>User provided configObj to be used instead of the one generated by editing the parameters through the TEAL GUI.  These values will override any set in the default configObj. The full set of parameters and their definitions are provided in section on the full set of parameters.</p>
</blockquote>
<p><strong id="wcsmap">wcsmap</strong> : object, optional</p>
<blockquote>
<p>User provided mapping class to be used in coordinate transformaions.  This class must include the following methods:</p>
<ul class="simple">
<li><strong>apply_shift</strong>: applies any corrections found in the image header to the WCS</li>
<li><strong>forward</strong>: performs the coordinate transformation from input to output WCS</li>
</ul>
</blockquote>
<p><strong id="input_dict">input_dict</strong> : dict, optional</p>
<blockquote>
<p>This dictionary contains all the parameters and user-set values for only those parameters which should have non-default values. All possible parameters and their definitions are provided in the description of the full set of parameters. These are the parameters which normally get set through the TEAL GUI and provided as part of the &#8216;configObj&#8217;.</p>
</blockquote>
<p><strong id="Input">Input</strong> : str or list of str</p>
<blockquote>
<p>The name or names of the input files to be processed, which can be provided in any of several forms as described by the <strong>files</strong> parameter. This parameter gets its value from the <strong>files</strong> parameter if one was provided there, otherwise, it can be set through the TEAL GUI.</p>
</blockquote>
<p><strong id="Output">Output</strong> : str</p>
<blockquote>
<p>The rootname for the output drizzled products. This step can result in the creation of several files, including:</p>
<blockquote>
<ul class="simple">
<li>copies of each input image as a FITS image, if workinplace=yes and/or input images are in GEIS format</li>
<li>mask files and coeffs files created by PyDrizzle for use by &#8216;drizzle&#8217;</li>
</ul>
</blockquote>
<p>If an association file has been given as input, this name will be used instead of the product name specified in the ASN file. Similarly, if a single exposure is provided, this rootname will be used for the output product instead of relying on input rootname. If no value is provided when a filelist or wild-card specification is given as input, then a rootname of &#8216;final&#8217; will be used.</p>
</blockquote>
<p><strong id="mdriztab">mdriztab</strong> : bool</p>
<blockquote>
<p>Specifies whether or not to use an MDRIZTAB reference table to specify the remaining MultiDrizzle parameter settings. If &#8216;True&#8217;, the values in the table will override the settings for the remainder of the parameters.</p>
</blockquote>
<p><strong id="refimage">refimage</strong> : str</p>
<blockquote>
<p>Optional &#8220;reference image&#8221; that can be provided, in which case MultiDrizzle will create a final product with the same WCS. This reference image should be a simple FITS file (single-group, no multiple extensions), and should have been already drizzled so that all of its distortion has been removed, and its WCS is completely rectified.</p>
</blockquote>
<p><strong id="runfile">runfile</strong> : str</p>
<blockquote>
<p>This log file will contain the IRAF CL commands necessary for performing the final combination manually using the &#8220;drizzle&#8221; task directly.</p>
</blockquote>
<p><strong id="workinplace">workinplace</strong> : bool</p>
<blockquote>
<p>This parameter specifies whether to perform all processing on the original, including skysubtraction and update of the DQ array. If set to &#8216;True&#8217;, then no copy of the input will be created for processing, and the original input will be modified directly by MultiDrizzle.</p>
</blockquote>
<p><strong id="updatewcs">updatewcs</strong> : bool</p>
<blockquote>
<p>This parameter specifies whether the WCS keywords are to be updated by running makewcs on the input data, or left alone. The update performed by makewcs not only recomputes the WCS based on the currently used IDCTAB, but also populates the header with the SIP coefficients. Also, for ACS/WFC images, the time-dependence correction will also be applied to the WCS and SIP keywords. This parameter should usually be set to &#8216;yes&#8217;, unless the WCS keywords have been carefully set by some other method, and need to be passed through to drizzle &#8216;as is&#8217;.</p>
</blockquote>
<p><strong id="wcskey">wcskey</strong> : str</p>
<blockquote>
<p>This parameter will correspond to the <em>key</em> for the WCS being selected by the user. It allows the user to select which WCS should be used for processing the images when multiple WCS&#8217;s have been updated in each input image header using the Paper I Multiple WCS FITS standard.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Use of this parameter should be done only when all input images have been updated using the Paper I FITS standard for specifying Multiple WCS&#8217;s in each image header. This parameter assumes that the same WCS letter corresponds to WCS&#8217;s which have been updated in a consistent manner. For example, all input images have been updated to be consistent with their distortion model in the WCS&#8217;s with key of <em>A</em>.</p>
</div>
</blockquote>
<p><strong id="coeffs">coeffs</strong> : bool</p>
<blockquote>
<p>This parameter determines whether to use the coefficients stored in the each input image header or not.  If turned off, no distortion coefficients will be applied during the coordinate transformations.</p>
</blockquote>
<p><strong id="context">context</strong> : bool</p>
<blockquote>
<p>This parameter specifies whether or not to create a context image during the final drizzle combination. The context image contains the information on what image(s) contributed to each pixel encoded as a bit-mask. More information on context images can be obtained from the ACS Data Handbook.</p>
</blockquote>
<p><strong id="clean">clean</strong> : bool</p>
<blockquote>
<p>The temporary files created by MultiDrizzle can be automatically removed by setting this parameter to &#8216;True&#8217;. The affected files would include the coefficients files and static mask files created by PyDrizzle, along with other intermediate files created by MultiDrizzle. It is often useful to retain the intermediate files and examine them when first learning how to run MultiDrizzle. But when running it routinely, or on a small disk drive, these files can be removed to save space.</p>
</blockquote>
<p><strong id="group">group</strong> : int or str</p>
<blockquote>
<p>A single FITS extension or group can be drizzled by setting this parameter. If an extension is provided, then only that chip will be drizzled onto the output frame. Either a FITS extension number or GEIS group number (such as &#8216;1&#8217;), or a FITS extension name (such as &#8216;sci,1&#8217;) may be specified.</p>
</blockquote>
<p><strong id="ra">ra</strong> : float</p>
<blockquote>
<p>Right ascension (in decimal degrees) of the center of the output image. If this is not specified, the code will calculate the center automatically based on the distribution of image dither positions.</p>
</blockquote>
<p><strong id="dec">dec</strong> : float</p>
<blockquote>
<p>Declination (in decimal degrees) of the center of the output image. If this is not specified, the code will calculate the center automatically based on the distribution of image dither positions.</p>
</blockquote>
<p><strong id="build">build</strong> : bool</p>
<blockquote>
<p>MultiDrizzle will combine the separate &#8216;drizzle&#8217; output files into a single multi-extension format FITS file when this parameter gets set to &#8216;True&#8217;. This combined output file will contain a SCI (science), a WHT (weight), and a CTX (context) extension. If set to &#8216;False&#8217;, each extension would remain as a separate simple FITS file on its own.</p>
</blockquote>
<p><strong id="shiftfile">shiftfile</strong> : str</p>
<blockquote>
<p>Name of optional input file containing the shifts to be applied to the input images to improve their registration. These shifts will be added to those calculated automatically from the image headers. The file should be organized as follows:</p>
<div class="highlight-python"><pre># units: pixels 
# frame: input
# form: delta
rootname  xshift   yshift   rotation   </pre>
</div>
</blockquote>
<p><strong id="staticfile">staticfile</strong> : str</p>
<blockquote>
<p>Name of the optional input static bad-pixel mask. The input data are multiplied by the contents of this static mask file.</p>
</blockquote>
<p><strong id="static">static</strong> : bool</p>
<blockquote>
<p>Create a static bad-pixel mask from the data?  This mask flags all pixels that deviate by more than &#8216;static_sig&#8217; sigma below the image median, since these pixels usually result from oversubtraction of bad pixels in the dark image during calibration.</p>
</blockquote>
<p><strong id="static_sig">static_sig</strong> : float</p>
<blockquote>
<p>The number of sigma below the RMS to use as the clipping limit for creating the static mask, defaulted to 4.0</p>
</blockquote>
<p><strong id="skysub">skysub</strong> : bool</p>
<blockquote>
<p>Turn on or off sky subtraction on the input data.</p>
</blockquote>
<p><strong id="skywidth">skywidth</strong> : float</p>
<blockquote>
<p>Bin width, in sigma, used to sample the distribution of pixel flux values in order to compute the sky background statistics.</p>
</blockquote>
<p><strong id="skystat">skystat</strong> : {&#8216;median&#8217;, &#8216;mode&#8217;, &#8216;mean&#8217;}</p>
<blockquote>
<p>Statistical method for determining the sky value from the image pixel values.</p>
</blockquote>
<p><strong id="skylower">skylower</strong> : float</p>
<blockquote>
<p>Lower limit of usable pixel values for computing the sky. 
This value should be specified in units of electrons.</p>
</blockquote>
<p><strong id="skyupper">skyupper</strong> : float</p>
<blockquote>
<p>Upper limit of usable pixel values for computing the sky. 
This value should be specified in units of electrons.</p>
</blockquote>
<p><strong id="skyclip">skyclip</strong> : int</p>
<blockquote>
<p>Number of clipping iterations to use when computing the sky value.</p>
</blockquote>
<p><strong id="skylsigma">skylsigma</strong> : float</p>
<blockquote>
<p>Lower clipping limit, in sigma, used when computing the sky value.</p>
</blockquote>
<p><strong id="skyusigma">skyusigma</strong> : float</p>
<blockquote>
<p>Upper clipping limit, in sigma, used when computing the sky value.</p>
</blockquote>
<p><strong id="skyuser">skyuser</strong> : str</p>
<blockquote>
<p>Name of header keyword which records the sky value already subtracted from  the image by the user.</p>
</blockquote>
<p><strong id="driz_separate">driz_separate</strong> : bool</p>
<blockquote>
<p>This parameter specifies whether or not to drizzle each input image onto separate output images. The separate output images will all have the same WCS as the final combined output frame. 
These images are used to create the median image, needed for the cosmic ray rejection step further on.</p>
</blockquote>
<p><strong id="driz_sep_outnx">driz_sep_outnx</strong> : int</p>
<blockquote>
<p>Size of the X axis of the output images, in pixels, on which each input will be drizzled onto. 
If no value is specified, it will use the smallest size that can accommodate the full dithered field.</p>
</blockquote>
<p><strong id="driz_sep_outny">driz_sep_outny</strong> : int</p>
<blockquote>
<p>Size of the Y axis of the output images, in pixels, on which each input will be drizzled onto. 
If no value is specified, it will use the smallest size that can accommodate the full dithered field.</p>
</blockquote>
<p><strong id="driz_sep_kernel">driz_sep_kernel</strong> : {&#8216;square&#8217;,&#8217;point&#8217;,&#8217;gaussian&#8217;,&#8217;turbo&#8217;,&#8217;tophat&#8217;,&#8217;lanczos3&#8217;}</p>
<blockquote>
<p>For the initial separate drizzling operation only, this specifies the form of the kernel function used to distribute flux onto the separate output images. The options are currently:</p>
<blockquote>
<ul>
<li><p class="first"><strong>square</strong>: original classic drizzling kernel</p>
</li>
<li><p class="first"><strong>point</strong>: this kernel is a point so each input pixelcan only contribute to the single pixel which is closest to the output position. It is equivalent to the limit pixfrac -&gt; 0 and is very fast.</p>
</li>
<li><p class="first"><strong>gaussian</strong>: this kernel is a circular gaussian with FWHM equal to the value of pixfrac, measured in input pixels.</p>
</li>
<li><p class="first"><strong>turbo</strong>: this is similar to kernel=&#8221;square&#8221; but the box is always the same shape and size on the output grid and always aligned with the X and Y axes. This may result in a significant speed increase.</p>
</li>
<li><p class="first"><strong>tophat</strong>: the kernel is a circular &#8220;top hat&#8221; shape of width pixfrac. It effects only output pixels within pixfrac/2 of the output position.</p>
</li>
<li><p class="first"><strong>lanczos3</strong>: a Lanczos style kernel extending 3 pixels from the center. The Lanczos kernel is a damped, bounded form of the &#8220;sinc&#8221; interpolator and is very effective for resampling single images when scale=pixfrac=1. 
It leads to less resolution loss than the other kernels, and also less correlated noise in outputs.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The &#8216;&#8217;lanczos3&#8217;&#8217; kernel is however much slower than the others. It should never be used for pixfrac != 1.0 and is not recommended for scale != 1.0.</p>
</div>
</li>
</ul>
</blockquote>
<p>The default for this step is <strong>&#8220;turbo&#8221;</strong> since it is much faster than <strong>&#8220;square&#8221;</strong>, and it is quite satisfactory for the purposes 
of generating the median image. More information about the different kernels can be found in the help file for the drizzle task.</p>
</blockquote>
<p><strong id="driz_sep_wt_scl">driz_sep_wt_scl</strong> : float</p>
<blockquote>
<p>Weighting factor for input image. If driz_sep_wt_scl=exptime then the scaling value will be set equal to the exposure time found in the image header. This is the default recommended behavior. It is also possible to give wt_scl=expsq for weighting by the square of exposure time, which is optimal for  read-noise dominated images.</p>
</blockquote>
<p><strong id="driz_sep_scale">driz_sep_scale</strong> : float</p>
<blockquote>
<p>Linear size of the output pixels in arcseconds/pixel for each separate drizzled image (to be used in creating the median for cosmic ray rejection). The default value of INDEF specifies that the undistorted pixel scale for the first input image, as computed by PyDrizzle, will be used as the pixel scale for all the output images.</p>
</blockquote>
<p><strong id="driz_sep_pixfrac">driz_sep_pixfrac</strong> : float</p>
<blockquote>
<p>Fraction by which input pixels are &#8220;shrunk&#8221; before being drizzled onto the output image grid, given as a real number between 0 and 1. This specifies the size of the footprint, or &#8220;dropsize&#8221;, of a pixel in units of the input pixel size. If pixfrac is set to less than 0.001, the kernel get reset to &#8216;point&#8217; for more efficient processing. For the step of drizzling each input image onto a  separate output image, the default value of 1 is best in order to ensure that each output drizzled image is fully populated with pixels from the input image. For more information, see the help for the task &#8216;drizzle&#8217;.</p>
</blockquote>
<p><strong id="driz_sep_rot">driz_sep_rot</strong> : float</p>
<blockquote>
<p>Position Angle of output image&#8217;s Y-axis relative to North. A value of 0.0 would orient the final output image with North up. The default of INDEF specifies that the images will not be rotated, but will instead be drizzled in the default orientation for the camera, with the x and y axes of the drizzled image corresponding approximately to the detector axes. This conserves disk space, since these single drizzled images are only used in the intermediate step of creating a median image.</p>
</blockquote>
<p><strong id="driz_sep_fillval">driz_sep_fillval</strong> : int or INDEF</p>
<blockquote>
<p>Value to be assigned to output pixels that have zero weight or did not receive flux from any input pixels during drizzling. This parameter corresponds to the &#8216;fillval&#8217; parameter of the &#8216;drizzle&#8217; task. If the default of &#8216;INDEF&#8217; is used and if the weight in both the input and output images for a given pixel are zero, then the output pixel will be set to the value it would have had if the input had a non-zero weight. Otherwise, if a numerical value is provided (eg. 0), then these pixels will be set to that value.</p>
</blockquote>
<p><strong id="driz_sep_bits">driz_sep_bits</strong> : int</p>
<blockquote>
<p>Integer sum of all the DQ bit values from the input image&#8217;s DQ array that should be considered &#8216;good&#8217; when building the weighting mask. This can also be used to reset pixels to good if they had been flagged as cosmic rays during a previous run of MultiDrizzle, by adding the value 4096 for ACS and WFPC2 data. Please see the section on Selecting the &#8216;Bits&#8217; Parameter for a more detailed discussion.</p>
</blockquote>
<p><strong id="median">median</strong> : bool</p>
<blockquote>
<p>The user can specify whether or not to create a median image with this parameter. This median image will be used as the comparison &#8216;truth&#8217; image :in the cosmic ray rejection step.</p>
</blockquote>
<p><strong id="median_newmasks">median_newmasks</strong> : bool</p>
<blockquote>
<p>The user can specify whether or not to create new mask files when creating the median image. These masks are generated from the weight files produced previously by the &#8220;driz_separate&#8221; step, and would contain all the bad pixel information. These pixels will be excluded when calculating the median. Generally this step should be set to &#8220;yes&#8221;, unless it is desired to include bad pixels in generating the median.</p>
</blockquote>
<p><strong id="combine_type">combine_type</strong> : {&#8216;average&#8217;, &#8216;median&#8217;, &#8216;sum&#8217;, &#8216;minmed&#8217;}</p>
<blockquote>
<p>This parameter allows the user to choose which method is used to create the median image.  The &#8216;average&#8217;, &#8216;median&#8217;, and &#8216;sum&#8217; options set the mode of operation for using &#8216;numcombine&#8217; , a numpy method for median-combining arrays, to create the median image. The &#8220;minmed&#8221; option will produce an image that is generally the same as the median, except in cases where the median is significantly higher than the minimum good pixel value, in which case it will choose the minimum. The sigma thresholds for this decision are provided by the &#8220;combine_nsigma&#8221; parameter. However, as the &#8220;combine_nsigma&#8221; parameter does not adjust for the larger probability of a single &#8220;nsigma&#8221; event with a greater number of images, &#8220;minmed&#8221; will bias the comparison image low for a large number of images. &#8220;minmed&#8221; is highly recommended for three images, and good for four to six or more images. &#8220;minmed&#8221; should definitely be avoided for ten or more images.</p>
<p>A value of &#8216;median&#8217; is the recommended method for a large number of images, and works equally well as minmed down to  about four images. However, the user should set the &#8220;combine_nhigh&#8221; parameter to one when using &#8220;median&#8221; with four images, and consider raising this parameter for larger numbers of images. As a median averages the two inner values when the number of values being considered is even, the user may want to keep the total number of images minus &#8220;combine_nhigh&#8221; odd when using &#8220;median&#8221;.</p>
</blockquote>
<p><strong id="combine_nsigma">combine_nsigma</strong> : float</p>
<blockquote>
<p>Sigmas used for accepting minimum values instead of median values when using the &#8216;minmed&#8217; combination method. If two values are specified, then the first value will be used in the initial choice between median and minimum, while the second value will be used in the &#8220;growing&#8221; step to reject additional pixels around those identified in the first step. If only one value is specified, then it is used in both steps.</p>
</blockquote>
<p><strong id="combine_nlow">combine_nlow</strong> : int</p>
<blockquote>
<p>This parameter sets the number of low value pixels to reject automatically during image combination.</p>
</blockquote>
<p><strong id="combine_nhigh">combine_nhigh</strong> : int</p>
<blockquote>
<p>This parameter sets the number of high value pixels to reject automatically during image combination.</p>
</blockquote>
<p><strong id="combine_lthresh">combine_lthresh</strong> : float</p>
<blockquote>
<p>Sets the lower threshold for clipping input pixel values during image combination. This value gets passed directly to &#8216;imcombine&#8217; for use in creating the median image. If None, no thresholds are used at all.</p>
</blockquote>
<p><strong id="combine_hthresh">combine_hthresh</strong> : float</p>
<blockquote>
<p>Sets the upper threshold for clipping input pixel values during image combination. This value gets passed directly to &#8216;imcombine&#8217; for use in creating the median image. If None, no thresholds are used at all.</p>
</blockquote>
<p><strong id="combine_grow">combine_grow</strong> : int</p>
<blockquote>
<p>Width in pixels for additional pixels to be rejected in an image with a rejected pixel from one of the rejection algorithms. This parameter is used to set the &#8216;grow&#8217; parameter in &#8216;imcombine&#8217; for use in creating the median image.</p>
</blockquote>
<p><strong id="blot">blot</strong> : bool</p>
<blockquote>
<p>Perform the blot operation on the median image. The output will be median smoothed images which match each input chips location, these are used in the cosmic ray rejection step.</p>
</blockquote>
<p><strong id="blot_interp">blot_interp</strong> : {&#8216;nearest&#8217;, &#8216;linear&#8217;, &#8216;poly3&#8217;, &#8216;poly5&#8217;, &#8216;sinc&#8217;}</p>
<blockquote>
<p>Type of interpolation to use when blotting drizzled images back to their original WCS. Valid options are:</p>
<blockquote>
<ul class="simple">
<li><strong>nearest</strong>: Nearest neighbor</li>
<li><strong>linear</strong>: Bilinear interpolation in x and y</li>
<li><strong>poly3</strong>: Third order interior polynomial in x and y</li>
<li><strong>poly5</strong>: Fifth order interior polynomial in x and y</li>
<li><strong>sinc</strong>: Sinc interpolation; accurate but slow</li>
</ul>
</blockquote>
<p>The &#8216;poly5&#8217; interpolation method has been chosen as the default because it is relatively fast and accurate.</p>
<p>If &#8216;sinc&#8217; interpolation has been selected, then it will use the value of the parameter &#8216;blot_sinscl&#8217; to specify the size of the sinc interpolation kernel.</p>
</blockquote>
<p><strong id="blot_sinscl">blot_sinscl</strong> : int</p>
<blockquote>
<p>Size of the sinc interpolation kernel in pixels.</p>
</blockquote>
<p><strong id="driz_cr">driz_cr</strong> : bool</p>
<blockquote>
<p>Perform cosmic-ray detection? If set to &#8220;yes&#8221;, it will detect cosmic-rays and create cosmic-ray masks using the algorithms from &#8216;deriv&#8217; and &#8216;driz_cr&#8217;.</p>
</blockquote>
<p><strong id="driz_cr_corr">driz_cr_corr</strong> : bool</p>
<blockquote>
<p>Create a cosmic-ray cleaned input image? The cosmic-ray cleaned _cor image will be generated directly from the input image, and a corresponding _crmask file will be written to document the pixels detected as affected by cosmic-rays.</p>
</blockquote>
<p><strong id="driz_cr_snr">driz_cr_snr</strong> : list of floats</p>
<blockquote>
<p>These values specify the signal-to-noise ratios for the &#8216;driz_cr&#8217; task to use in detecting cosmic rays. See the help file for &#8216;driz_cr&#8217; for further discussion of this parameter.</p>
</blockquote>
<p><strong id="driz_cr_scale">driz_cr_scale</strong> : float</p>
<blockquote>
<p>Scaling factor applied to the derivative in &#8216;driz_cr&#8217; when detecting cosmic-rays. See the help file for &#8216;driz_cr&#8217; for further discussion of this parameter.</p>
</blockquote>
<p><strong id="driz_cr_grow">driz_cr_grow</strong> : int</p>
<blockquote>
<p>Radius (in pixels) around each detected cosmic-ray to use more stringent detection criteria for additional cosmic rays.</p>
</blockquote>
<p><strong id="driz_cr_ctegrow">driz_cr_ctegrow</strong> : int</p>
<blockquote>
<p>Length (in pixels) of CTE tail to mask in drizzled output.</p>
</blockquote>
<p><strong id="driz_combine">driz_combine</strong> : bool</p>
<blockquote>
<p>This parameter specifies whether or not to drizzle each input image onto the final output image. This applies the generated cosmic-ray masks to the input images and create a final, cleaned, distortion-corrected product.</p>
</blockquote>
<p><strong id="final_wht_type">final_wht_type</strong> : {&#8216;EXP&#8217;, &#8216;ERR&#8217;, &#8216;IVM&#8217;}</p>
<blockquote>
<p>Specify the type of weighting image to apply with the bad pixel mask</p>
</blockquote>
<p><strong id="for the final drizzle step.  The options are:">for the final drizzle step.  The options are:</strong> :</p>
<blockquote>
<ul class="simple">
<li><strong>EXP</strong>: The default of &#8216;EXP&#8217; indicates that the images will be weighted according to their exposure time, which is the standard behavior for drizzle. This weighting is a good approximation in the regime where the noise is dominated by photon counts from the sources, while contributions from sky background, read-noise and dark current are negligible. This option is provided as the default since it produces reliable weighting for all types of data, including older instruments (eg., WFPC2) where more sophisticated options may not be available.</li>
<li><strong>ERR</strong>: Specifying &#8216;ERR&#8217; is an alternative for ACS and STIS data, in which case the final drizzled images will be weighted according to the inverse variance of each pixel in the input exposure files, calculated from the error array data extension that is in each calibrated input exposure file. This array encapsulates all the noise sources in each exposure, including read-noise, dark current and sky background, as well as Poisson noise from the sources themselves, and this also includes a dependence upon exposure time. For WFPC2, the ERR array is not produced during calibration, therefore this option is not available. We advise extreme caution when selecting the &#8220;ERR&#8221; option, since the nature of this weighting scheme can introduce photometric discrepancies in sharp unresolved sources, although these effects are minimized for sources with gradual variations between pixels. The &#8220;EXP&#8221; weighting option does not suffer from these effects and is therefore the recommended option.</li>
<li><strong>IVM</strong>: Finally, &#8216;IVM&#8217; can be specified, in which case the user can either supply their own inverse-variance weighting map or let Multidrizzle generate one on-the-fly automatically during the final drizzle step. This may be necessary for specific purposes, for example to create a drizzled weight file for software such as Sextractor, which expects a weight image that contains all the background noise sources (sky level, read-noise, dark current, etc) but not the Poisson noise from the objects themselves. The user can create the inverse variance images and then specify their names using the &#8216;input&#8217; parameter for MultiDrizzle to specify an <a class="reference external" href="mailto:'&#37;&#52;&#48;file">'<span>&#64;</span>file</a>&#8216;. This would be a single ASCII file containing the list of input calibrated exposure filenames (one per line), with a second column containing the name of the IVM file corresponding to each calibrated exposure. Each IVM file must have the same file format as the input file, and if given as multi-extension FITS files (for example, ACS or STIS data) then the IVM extension must have the EXTNAME of &#8216;IVM&#8217;. If no IVM files are specified on input, then Multidrizzle will rely on the flat-field reference file and computed dark value from the image header to automatically generate an IVM file specific to each exposure.</li>
</ul>
</blockquote>
<p><strong id="final_outnx">final_outnx</strong> : int</p>
<blockquote>
<p>Size of the X axis of the output images, in pixels, on which each input will be drizzled onto. If no value is specified, it will use the smallest size that can accommodate the full dithered field.</p>
</blockquote>
<p><strong id="final_outny">final_outny</strong> : int</p>
<blockquote>
<p>Size of the Y axis of the output images, in pixels, on which each input will be drizzled onto. If no value is specified, it will use the smallest size that can accommodate the full dithered field.</p>
</blockquote>
<p><strong id="final_kernel">final_kernel</strong> : {&#8216;square&#8217;,&#8217;point&#8217;,&#8217;gaussian&#8217;,&#8217;turbo&#8217;,&#8217;tophat&#8217;,&#8217;lanczos3&#8217;}</p>
<blockquote>
<p>For the initial separate drizzling operation only, this specifies the form of the kernel function used to distribute flux onto the separate output images. The options are currently:</p>
<blockquote>
<ul class="simple">
<li><strong>square</strong>: original classic drizzling kernel</li>
<li><strong>point</strong>: this kernel is a point so each input pixelcan only contribute to the single pixel which is closest to the output position. It is equivalent to the limit pixfrac -&gt; 0 and is very fast.</li>
<li><strong>gaussian</strong>: this kernel is a circular gaussian with FWHM equal to the value of pixfrac, measured in input pixels.</li>
<li><strong>turbo</strong>: this is similar to kernel=&#8221;square&#8221; but the box is always the same shape and size on the output grid and always aligned with the X and Y axes. This may result in a significant speed increase.</li>
<li><strong>tophat</strong>: the kernel is a circular &#8220;top hat&#8221; shape of width pixfrac. It effects only output pixels within pixfrac/2 of the output position.</li>
<li><strong>lanczos3</strong>: a Lanczos style kernel extending 3 pixels from the center. The Lanczos kernel is a damped, bounded form of the &#8220;sinc&#8221; interpolator and is very effective for resampling single images when scale=pixfrac=1. It leads to less resolution loss than the other kernels, and also less correlated noise in outputs.</li>
</ul>
</blockquote>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The &#8216;&#8217;lanczos3&#8217;&#8217; kernel is much slower than the other options. It should never be used for pixfrac != 1.0 and is not recommended for scale != 1.0.</p>
</div>
<p>The default for this step is &#8220;turbo&#8221; since it is much faster than &#8220;square&#8221;, and it is quite satisfactory for the purposes 
of generating the median image. More information about the different kernels can be found in the help file for the drizzle task.</p>
</blockquote>
<p><strong id="final_wt_scl">final_wt_scl</strong> : str</p>
<blockquote>
<p>Weighting factor for input image. If final_wt_scl=exptime then the scaling value will be set equal to the exposure time found in the image header. This is the default recommended behavior. It is also possible to give wt_scl=expsq for weighting by the square of exposure time, which is optimal for read-noise dominated images.</p>
</blockquote>
<p><strong id="final_scale">final_scale</strong> : float</p>
<blockquote>
<p>Linear size of the output pixels in arcseconds/pixel for each separate drizzled image (to be used in creating the median for cosmic ray rejection). The default value of INDEF specifies that the undistorted pixel scale for the first input image will be used as the pixel scale for all the output images.</p>
</blockquote>
<p><strong id="final_pixfrac">final_pixfrac</strong> : float</p>
<blockquote>
<p>Fraction by which input pixels are &#8220;shrunk&#8221; before being drizzled onto the output image grid, given as a real number between 0 and 1. This specifies the size of the footprint, or &#8220;dropsize&#8221;, of a pixel in units of the input pixel size. If pixfrac is set to less than 0.001, the kernel get reset to &#8216;point&#8217; for more efficient processing. For the step of drizzling each input image onto a separate output image, the default value of 1 is best in order to ensure that each output drizzled image is fully populated with pixels from the input image. For more information, see the help for the task &#8216;drizzle&#8217;.</p>
</blockquote>
<p><strong id="final_rot">final_rot</strong> : float</p>
<blockquote>
<p>Position Angle of output image&#8217;s Y-axis relative to North. A value of 0.0 would orient the final output image with North up. The default of INDEF specifies that the images will not be rotated, but will instead be drizzled in the default orientation for the camera, with the x and y axes of the drizzled image corresponding approximately to the detector axes. This conserves disk space, since these single drizzled images are only used in the intermediate step of creating a median image.</p>
</blockquote>
<p><strong id="final_fillval">final_fillval</strong> : float or INDEF</p>
<blockquote>
<p>Value to be assigned to output pixels that have zero weight or did not receive flux from any input pixels during drizzling. This parameter corresponds to the &#8216;fillval&#8217; parameter of the &#8216;drizzle&#8217; task. If the default of &#8216;INDEF&#8217; is used and if the weight in both the input and output images for a given pixel are zero, then the output pixel will be set to the value it would have had if the input had a non-zero weight. Otherwise, if a numerical value is provided (eg. 0), then these pixels will be set to that value.</p>
</blockquote>
<p><strong id="final_bits">final_bits</strong> : int</p>
<blockquote>
<p>Integer sum of all the DQ bit values from the input image&#8217;s DQ array that should be considered &#8216;good&#8217; when building the weighting mask. This can also be used to reset pixels to good if they had been flagged as cosmic rays during a previous run of MultiDrizzle, by adding the value 4096 for ACS and WFPC2 data. Please see the section on Selecting the &#8216;Bits&#8217; Parameter for a more detailed discussion.</p>
</blockquote>
<p><strong id="final_units">final_units</strong> : str</p>
<blockquote>
<p>This parameter determines the units of the final drizzle-combined image, and can either be &#8216;counts&#8217; or &#8216;cps&#8217;.  It is passed through to &#8216;drizzle&#8217; in the final drizzle step.</p>
</blockquote>
<p><strong id="gain">gain</strong> : float</p>
<blockquote>
<p>Value used to override instrument specific default gain values.  The value is assumed to be in units of electrons/count.  This parameter should not be populated if the &#8216;&#8217;gainkeyword&#8217;&#8217; parameter is in use.</p>
</blockquote>
<p><strong id="gainkeyword">gainkeyword</strong> : str</p>
<blockquote>
<p>Keyword used to specify a value to be used to override instrument specific default gain values.  The value is assumed to be in units of electrons/count. This parameter should not be populated if the &#8216;&#8217;gain&#8217;&#8217; parameter is in use.</p>
</blockquote>
<p><strong id="rdnoise">rdnoise</strong> : float</p>
<blockquote>
<p>Value used to override instrument specific default readnoise values.  The value is assumed to be in units of electrons.  This parameter should not be populated if the &#8216;&#8217;rnkeyword&#8217;&#8217; parameter is in use.</p>
</blockquote>
<p><strong id="rnkeyword">rnkeyword</strong> : str</p>
<blockquote>
<p>Keyword used to specify a value to be used to override instrument specific default readnoise values.  The value is assumed to be in units of electrons. This parameter should not be populated if the &#8216;&#8217;rdnoise&#8217;&#8217; parameter is in use.</p>
</blockquote>
<p><strong id="exptime">exptime</strong> : float</p>
<blockquote>
<p>Value used to override default exposure time image header values.  The value is assumed to be in units of seconds.  This parameter should not be populated if the &#8216;&#8217;expkeyword&#8217;&#8217; parameter is in use.</p>
</blockquote>
<p><strong id="expkeyword">expkeyword</strong> : str</p>
<blockquote class="last">
<p>Keyword used to specify a value to be used to override default exposure time image header values.  The value is assumed to be in units of seconds. This parameter should not be populated if the &#8216;&#8217;exptime&#8217;&#8217; parameter is in use.</p>
</blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition-see-also admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><tt class="xref py py-obj docutils literal"><span class="pre">betadrizzle.drizzle</span></tt></dt>
<dd>Apply the &#8216;drizzle&#8217; algorithm to the images</dd>
<dt><tt class="xref py py-obj docutils literal"><span class="pre">betadrizzle.blot</span></tt></dt>
<dd>Apply the &#8216;blot&#8217; algorithm to drizzled images</dd>
<dt><a class="reference internal" href="sky.html#module-betadrizzle.sky" title="betadrizzle.sky"><tt class="xref py py-obj docutils literal"><span class="pre">betadrizzle.sky</span></tt></a></dt>
<dd>Perform sky subtraction</dd>
<dt><tt class="xref py py-obj docutils literal"><span class="pre">betadrizzle.median</span></tt></dt>
<dd>Create a median combined image from a set of drizzled images</dd>
<dt><a class="reference internal" href="drizcr.html#module-betadrizzle.drizCR" title="betadrizzle.drizCR"><tt class="xref py py-obj docutils literal"><span class="pre">betadrizzle.drizCR</span></tt></a></dt>
<dd>Identify cosmic-rays by comparing blotted, median images to the original input images</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Something to keep in mind is that the full MultiDrizzle interface will make backup copies of your original files and place them in the <strong>OrIg_files/</strong> directory of you current working directory.</p>
<p class="rubric">Examples</p>
<p>This task also has the ability to be called directly from Python for use in larger tasks.</p>
<p>The primary Python interface to Multidrizzle has been developed as:</p>
<div class="highlight-python"><pre>def MultiDrizzle('*flt.fits', editpars=False, configObj=None, wcsmap=None, **input_dict)</pre>
</div>
<p>A basic example of how to call this from within a Python task would be:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">betadrizzle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">betadrizzle</span><span class="o">.</span><span class="n">MultiDrizzle</span><span class="p">(</span><span class="s">&#39;*flt.fits&#39;</span><span class="p">,</span> <span class="n">editpars</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="np-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="imageobject.html" title="imageObject Classes"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to betadrizzle’s documentation!"
             >previous</a> |</li>
        <li><a href="index.html">betadrizzle v4.0.6 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2010, Warren Hack, Megan Sosey, Michael Droettboom, Nadia Dencheva.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.5.
    </div>
  </body>
</html>
